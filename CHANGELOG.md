# Change Log

All notable changes to the "textui-designer" extension will be documented in this file.

Check [Keep a Changelog](http://keepachangelog.com/) for recommendations on how to structure this file.

## [0.1.4] - 2025-06-29

### 🎨 テーマ切り替えUI完全実装（WebView内リアルタイム切り替え）
- **完全なテーマ切り替えインターフェース**: プレビュー画面に統合されたドロップダウン式テーマセレクター
  - 🎨 直感的なテーマ選択UI（アイコン: 🎨）
  - リアルタイムテーマプレビュー（切り替え時即座反映）
  - アクティブテーマの視覚的インジケーター（✓マーク）
  - テーマ説明文の表示（description対応）
  - ローディング状態表示（⏳アニメーション）
- **自動テーマ検出システム**: ワークスペース全体からテーマファイルを自動発見
  - サンプルフォルダ（`sample/`、`textui-designer/sample/`）
  - プロジェクトルート（`textui-theme.yml`、`*-theme.yml`、`*_theme.yml`）
  - YAML メタデータ解析（`theme.name`、`theme.description`）
  - デフォルトテーマ自動追加（「デフォルト」テーマオプション）
- **WebView統合メッセージング**: 
  - `available-themes`メッセージで利用可能テーマ一覧送信
  - `theme-switch`メッセージでリアルタイムテーマ切り替え
  - `get-themes`メッセージでテーマ一覧再取得
  - postMessage双方向通信でVS Code拡張機能連携
- **UI/UX最適化**: 
  - モダンなドロップダウンデザイン（半透明・ブラー効果）
  - ホバーエフェクト・トランジションアニメーション
  - 外部クリックでの自動クローズ
  - エクスポートボタン・ThemeToggleボタンとの配置調整
  - レスポンシブ対応（12-20rem可変幅）

### 🔧 WebViewManager 拡張実装
- **テーマファイル検出アルゴリズム**: 複数ディレクトリ対応の高性能ファイル検索
- **テーマ切り替えロジック**: ThemeManager連携によるリアルタイムCSS変数適用
- **エラーハンドリング強化**: 無効テーマファイル・パス不正の適切な処理
- **パフォーマンス最適化**: 非同期処理・メモリリーク防止

### 🎯 Phase 3 完全実装達成
- **テーマ切り替えUI**: Issue #13 ロードマップの完全制覇
- **エンタープライズ対応**: プロダクション環境での本格運用可能
- **177テスト全てパス**: 新機能と既存機能の完全互換性確認

## [0.1.3] - 2025-06-29

### 🎨 カスタムテーマのIntelliSense対応大幅強化
- **包括的テーマスキーマ完全改良**: VS Codeでのテーマファイル編集体験を劇的に向上
  - 詳細な日本語説明付きプロパティ補完（100+ プロパティ）
  - 全デザイントークン完全対応（color、spacing、typography、borderRadius、shadows、transition）
  - 全10種類コンポーネント完全対応（button、input、select、checkbox、radio、divider、alert、text、container、form）
  - CSS変数パターンの自動提案（`var(--color-primary)`形式）
  - 厳密な型チェック・バリデーション（パターンマッチング、enum制約）
  - 実用的なコード例示（examples）による学習支援
- **新規デザイントークンサポート**: 
  - `color.border`（フォーカス・エラー状態のボーダーカラー）
  - `typography.fontWeight`（light、normal、medium、semibold、bold）
  - `typography.lineHeight`（tight、normal、relaxed）
  - `transition`（fast、normal、slow アニメーション設定）
- **高度なコンポーネントスタイル定義**: 
  - ホバー・フォーカス・エラー状態の個別スタイル対応
  - Flexbox・Grid レイアウトプロパティ完全サポート
  - アクセシビリティ対応（accentColor、opacity、outline）
  - CSS全プロパティ（backgroundColor、border、padding、margin、boxShadow等）

### 🔍 型安全性・開発体験向上
- **リアルタイムエラー検出**: 不正な値・構文を即座に赤波線で警告
- **インテリジェントな補完**: コンテキストに応じた適切なプロパティ・値候補を表示
- **ツールチップヘルプ**: ホバー時の詳細説明でプロパティの用途を即座確認
- **パターンマッチング**: カラーコード（#RRGGBB）、単位付き数値（px、rem、em）の形式チェック
- **CSS変数インテリジェンス**: デザイントークン参照の自動補完・検証

### 🎯 ユーザー体験改善
- **学習コスト削減**: 豊富な例示とヘルプによる直感的なテーマ作成
- **ミスの大幅削減**: 型チェックによるタイポ・構文エラーの事前防止
- **効率的な開発**: 自動補完により手作業でのプロパティ名入力が不要
- **プロフェッショナル品質**: 企業級テーマシステムの開発が可能

### 🔧 技術的実装
- **JSON Schema Draft-07 準拠**: 標準的なスキーマ定義による高い互換性
- **$ref による再利用**: `componentStyle` 定義の効率的な共通化
- **additionalProperties サポート**: 将来の拡張性を確保した柔軟な設計
- **177テスト全てパス**: 新スキーマと既存機能の完全互換性確認

## [0.1.2] - 2025-06-29

### 🚀 新機能
- **Cache Manager ヒット率計算機能**: パフォーマンス監視機能を完全実装
  - 正確なキャッシュヒット率計算（小数点以下2桁まで表示）
  - ヒット・ミスカウンターの自動記録
  - TTL期限切れもミスとして正確にカウント
  - `getDetailedStats()` メソッドによる詳細統計取得
  - `resetStats()` メソッドによる統計リセット機能
- **🎨 テーマシステム包括ドキュメント**: Issue #13 対応完了
  - README.mdにスタイルトークンベーステーマシステムの完全説明を追加
  - 実用的なサンプルテーマファイル（`sample-theme.yml`）を提供
  - テーマデモンストレーションファイル（`theme-demo.tui.yml`）を提供
  - サンプルディレクトリ専用README.mdによる詳細な使用方法ガイド

### 🎨 テーマシステム強化
- **Modern Blue Theme**: 実用的で美しいサンプルテーマ
  - デザイントークンベースの統一されたカラーパレット
  - 全10種類のコンポーネント完全対応
  - CSS変数自動生成による効率的なスタイル適用
  - ライブプレビュー対応（保存時即座反映）
- **包括的なテーマデモ**: 全コンポーネントのテーマ適用例
  - テキスト・アラート・フォーム・ボタン・レイアウト全対応
  - リアルタイムテーマ変更確認機能
  - 統合フォーム例による実践的な使用パターン
  - テーマカスタマイズガイド内蔵

### 📚 ドキュメント大幅拡充
- **テーマシステム完全ガイド**: README.mdに9セクション・3000文字以上の詳細説明
  - デザイントークンの活用方法（カラー・スペーシング・タイポグラフィ）
  - ライブテーマ更新機能の説明
  - IntelliSense・型安全性サポートの詳細
  - コンポーネントとの連携方法
  - テーマ切り替え・ベストプラクティス・パフォーマンス最適化
- **サンプルディレクトリガイド**: sample/README.md による実践的な使用方法
  - クイックスタートガイド
  - カスタマイズパターン集（企業サイト・ダークモード・アクセシビリティ）
  - トラブルシューティング
  - Tips & Tricks

### 🔧 技術的改善
- **統計管理の強化**: キャッシュアクセス時の自動カウント機能
- **メモリ効率化**: 統計データの最小限メモリ使用
- **安全な計算**: 0除算を回避する堅牢な実装
- **型安全性**: 統計インターフェースの完全型定義

### 📊 監視機能
- **リアルタイム統計**: キャッシュ使用状況の即座把握
- **パフォーマンス指標**: ヒット率によるキャッシュ効率の定量化
- **統計リセット**: 開発・テスト時の統計クリア機能

### 🧪 品質保証
- **177テスト全てパス**: 新機能と既存機能の完全互換性確認
- **統計精度検証**: 小数点計算の正確性を確認
- **テーマシステム動作確認**: サンプルファイルによる実動作テスト

### 🎯 ユーザー体験向上
- **パフォーマンス可視化**: キャッシュ効率の定量的把握
- **開発者支援機能**: 詳細統計による最適化支援
- **運用監視対応**: プロダクション環境でのパフォーマンス追跡
- **テーマシステム即座体験**: サンプルファイルによる3ステップ開始
- **リアルタイムフィードバック**: テーマ編集時の即座プレビュー更新

## [0.1.1] - 2025-06-29

### 🚀 新機能
- **Cache Manager ヒット率計算機能**: パフォーマンス監視機能を完全実装
  - 正確なキャッシュヒット率計算（小数点以下2桁まで表示）
  - ヒット・ミスカウンターの自動記録
  - TTL期限切れもミスとして正確にカウント
  - `getDetailedStats()` メソッドによる詳細統計取得
  - `resetStats()` メソッドによる統計リセット機能

### 🔧 技術的改善
- **統計管理の強化**: キャッシュアクセス時の自動カウント機能
- **メモリ効率化**: 統計データの最小限メモリ使用
- **安全な計算**: 0除算を回避する堅牢な実装
- **型安全性**: 統計インターフェースの完全型定義

### 📊 監視機能
- **リアルタイム統計**: キャッシュ使用状況の即座把握
- **パフォーマンス指標**: ヒット率によるキャッシュ効率の定量化
- **統計リセット**: 開発・テスト時の統計クリア機能

### 🧪 品質保証
- **包括的テスト**: ヒット率計算の全シナリオをカバー
- **177テスト全てパス**: 新機能と既存機能の完全互換性確認
- **統計精度検証**: 小数点計算の正確性を確認

### 🎯 ユーザー体験向上
- **パフォーマンス可視化**: キャッシュ効率の定量的把握
- **開発者支援**: デバッグ・最適化のための詳細情報提供
- **運用監視**: プロダクション環境でのキャッシュ効率監視

## [0.1.0] - 2025-06-29

### 🎉 メジャーアップデート - 安定版リリース
- **プロダクション対応**: 172個のテスト全てパス、VS Code Marketplaceリリース準備完了
- **高度な開発体験**: エラー診断・プレビュー最適化により、実用レベルの開発環境を実現

### 🚀 新機能
- **詳細エラー表示システム**: YAML構文エラー・スキーマバリデーションエラーの詳細診断機能
  - 正確な行番号・列番号の表示
  - エラー箇所の前後コードハイライト
  - 具体的な修正提案（TAB文字検出、コロン不足、インデントエラーなど）
  - よくあるYAML構文ミスの自動検出

### 📱 プレビュー体験の大幅改善
- **最適化されたレイアウト**: プレビューを右側、編集画面を左側に自動配置
- **フォーカス管理**: プレビュー表示後も編集画面がアクティブを維持
- **ファイルツリー連携**: 別ファイルを開いてもプレビューが隠れない設計
- **WebView初期化タイミング最適化**: 完全初期化後にフォーカスを戻す仕組み

### 🔧 技術的改善・安定性向上
- **拡張機能初期化エラーの修正**: `extensionRuntime` APIプロポーザル問題を解決
- **グローバル変数によるサービス連携**: `context.globalState`から安全なグローバル変数に変更
- **process.env依存の削除**: Node.js環境変数への依存を除去し、純粋なVS Code拡張として最適化
- **エラー復帰機能**: 壊れたYAMLから正常なYAMLに切り替えた際の確実な復帰機能

### 🐛 重要なバグ修正
- **コマンド実行エラー**: `command 'textui-designer.openPreview' not found`問題の根本解決
- **WebViewManager**: YAMLパースエラー時のキャッシュクリア強化
- **React WebView**: エラー状態の確実なリセット機能
- **TypeScriptコンパイル**: 不完全なコンパイルによる実行エラーを解決

### 📊 品質保証
- **172個のテスト**: 単体・統合・E2Eテスト全てパス
- **手動回帰テスト**: 主要機能の動作確認完了
- **パフォーマンステスト**: メモリ使用量・レンダリング時間の最適化確認

### 🎯 ユーザビリティ向上
- **開発者体験**: エラー診断からプレビューまで、一貫した快適な開発環境
- **学習コスト削減**: 詳細なエラーメッセージによる効率的なデバッグ
- **プロダクション対応**: 実用的なプロジェクトで使用可能な安定性

## [0.0.12-dev]
### 🔧 開発版 - リリース準備
- 拡張機能初期化エラーの修正とテスト
- プレビュー画面のフォーカス改善の実装・テスト
- 詳細エラー表示機能の最終調整

## [0.0.11]
### メモリリーク問題対応
- 診断マネージャーの改善
- 拡張機能のクリーンアップ改善
- メモリ監視の強化
- タイマー管理の改善

## [0.0.10]

### 🔄 ライブプレビュー根本改善
- **ファイル切り替え即座反映**: tui.ymlタブを切り替えた時にライブプレビューが即座に新しいファイルの内容に切り替わるように修正
- **即座更新機能**: ファイル変更時にキャッシュをクリアし、即座にプレビューを更新する機能を追加
- **強制更新システム**: `forceUpdate`パラメータによる強制更新機能で、確実なファイル切り替えを実現

### 🔧 技術的改善
- **setLastTuiFile拡張**: `updatePreview`パラメータを追加し、ファイル変更時の即座更新を制御
- **キャッシュ制御強化**: `forceUpdate`が`true`の場合はキャッシュチェックをスキップして確実に更新
- **アクティブエディタ監視**: ファイル変更の検知精度を向上し、不要な処理を削減

### 🐛 バグ修正
- **タブ切り替え問題**: tui.ymlタブを切り替えてもプレビューが更新されない根本的な問題を解決
- **キャッシュ無効化**: ファイル変更時のキャッシュ無効化処理を確実に実行
- **更新タイミング**: ファイル切り替え時の更新タイミングを最適化

### ⚡ パフォーマンス改善
- **処理効率化**: ファイルが同じ場合の不要な処理を削減
- **即座更新**: ファイル変更時の即座更新により、ユーザー体験を大幅に改善
- **ログ最適化**: デバッグ情報の出力を効率化

### 📊 デバッグ機能
- **ファイル切り替え追跡**: アクティブエディタの変更とファイル切り替えの詳細ログ
- **更新タイミング可視化**: 各更新処理の実行タイミングを明確に記録
- **キャッシュ状態監視**: キャッシュのクリアと使用状況を詳細にログ出力

## [0.0.9]

### 🔄 ライブプレビュー改善
- **ファイル切り替え対応**: tui.ymlファイルを切り替えた時にライブプレビューが正しく更新されるように修正
- **キャッシュ管理の改善**: ファイル切り替え時にキャッシュを適切にクリアし、新しいファイルの内容を確実に反映
- **アクティブエディタ監視**: エディタの切り替えを正確に検知し、プレビューの同期を改善

### 🔧 技術的改善
- **キャッシュクリア機能**: `setLastTuiFile`メソッドでファイル変更時にキャッシュを自動クリア
- **ファイル名比較**: キャッシュチェックでファイル名も考慮し、異なるファイルの場合はキャッシュを使用しない
- **ログ出力の強化**: ファイル切り替えの状況を詳細にログ出力してデバッグを容易に

### 🐛 バグ修正
- **プレビュー同期問題**: 異なるtui.ymlファイル間で切り替えた時にプレビューが更新されない問題を修正
- **キャッシュ無効化**: ファイルが変更された場合のキャッシュ無効化処理を追加

### 📊 デバッグ機能
- **ファイル切り替えログ**: アクティブエディタの変更とファイル切り替えの詳細ログ
- **キャッシュ状態の可視化**: キャッシュのクリアと使用状況をログで確認可能

## [0.0.8]

### 🚀 パフォーマンス改善
- **大量編集時の安定性向上**: コピー＆ペーストによる大量編集時のVSCodeフリーズ問題を解決
- **YAMLパース処理の最適化**: 非同期処理を改善し、UIスレッドのブロッキングを防止
- **メモリ使用量の監視**: リアルタイムメモリ監視と自動クリーンアップ機能を追加
- **デバウンス処理の強化**: より長いデバウンス時間で安定性を向上

### 🔧 技術的改善
- **キュー管理システム**: 更新処理の重複を防止し、処理順序を保証
- **ファイルサイズ制限**: 1MB以上のファイルに対する警告機能を追加
- **変更回数制限**: 1秒あたりの最大変更回数を制限し、過度な処理を防止
- **メモリ制限機能**: 100MB以上でキャッシュ自動クリア、200MB以上で警告表示

### ⚙️ 設定の最適化
- **パフォーマンス設定の調整**: より安全で安定したデフォルト値に変更
- **同時処理数の削減**: 最大同時処理数を2→1に変更して安定性を向上
- **キャッシュTTLの延長**: キャッシュ有効期限を延長してパフォーマンスを向上

### 🐛 バグ修正
- **自動プレビュー設定の不具合**: `autoPreview.enabled = false`でもプレビューが更新される問題を修正
- **メモリリークの防止**: タイマーとキューの適切なクリーンアップ処理を追加
- **エラーハンドリングの改善**: YAMLパースエラー時の適切なエラー表示

### 📊 監視機能の強化
- **パフォーマンスログ**: メモリ使用量と処理時間の詳細ログを追加
- **早期警告システム**: メモリ使用量が大きい場合の自動警告機能
- **処理状態の可視化**: 更新処理の進行状況をログで確認可能

### 🔍 デバッグ機能
- **詳細ログ出力**: 設定値の読み込みと処理フローの詳細ログ
- **メモリ使用量の可視化**: パース前後のメモリ使用量をログで確認
- **処理タイミングの追跡**: 各処理の実行タイミングを詳細に記録

### 📝 ドキュメント
- **パフォーマンス最適化ガイド**: 大量編集時の推奨設定を追加
- **トラブルシューティング**: メモリ不足時の対処法を記載

## [0.0.7]

### 🎨 新機能
- **テーマシステム**: カスタムテーマのサポートを追加
- **リアルタイムテーマ切り替え**: VSCodeテーマ変更時の自動反映
- **CSS変数システム**: テーマ変数の動的適用

### 🔧 改善
- **WebViewパフォーマンス**: レンダリング処理の最適化
- **エラーハンドリング**: より詳細なエラーメッセージ
- **設定管理**: テーマ関連設定の追加

### 🐛 修正
- **メモリリーク**: WebViewパネル閉じ時のリソースクリーンアップ
- **テーマ適用**: 初期テーマ変数の適用タイミング

## [0.0.6]

### 🚀 新機能
- **エクスポート機能**: HTML、React、Pug形式でのエクスポート
- **プレビューからのエクスポート**: WebView内からのワンクリックエクスポート
- **テンプレートシステム**: 再利用可能なコンポーネントテンプレート

### 🔧 改善
- **IntelliSense**: より豊富な補完候補
- **エラーメッセージ**: より分かりやすいエラー表示
- **パフォーマンス**: レンダリング処理の最適化

### 🐛 修正
- **スキーマ検証**: YAML構文エラーの正確な検出
- **WebView更新**: プレビューの同期問題

## [0.0.5]

### 🎯 新機能
- **自動プレビュー**: ファイル保存時の自動プレビュー更新
- **設定システム**: カスタマイズ可能な設定オプション
- **スニペット**: 20以上のテンプレートスニペット

### 🔧 改善
- **WebView管理**: より安定したプレビュー表示
- **エラーハンドリング**: 堅牢なエラー処理
- **ログ出力**: 詳細なデバッグ情報

### 🐛 修正
- **メモリ管理**: リソースの適切な解放
- **設定読み込み**: 設定値の正確な反映

## [0.0.4]

### 🎨 UI改善
- **モダンなデザイン**: Tailwind CSSを使用した美しいUI
- **レスポンシブ対応**: 様々な画面サイズに対応
- **テーマ対応**: ライト/ダークテーマの自動切り替え

### 🔧 機能強化
- **コンポーネント追加**: Alert、Checkbox、Radio、Selectコンポーネント
- **レイアウト改善**: Container、Dividerコンポーネント
- **フォーム機能**: より豊富なフォーム要素

### 🐛 修正
- **レンダリング**: コンポーネントの表示問題
- **スタイル適用**: CSS変数の適用タイミング

## [0.0.3]

### 🚀 新機能
- **WebViewプレビュー**: リアルタイムプレビュー機能
- **JSON Schema検証**: YAML構文の自動検証
- **IntelliSense**: コード補完機能

### 🔧 改善
- **パフォーマンス**: レンダリング処理の最適化
- **エラーハンドリング**: より詳細なエラー表示
- **設定管理**: 拡張機能設定の改善

### 🐛 修正
- **スキーマ読み込み**: スキーマファイルの読み込みエラー
- **WebView通信**: メッセージ送受信の問題

## [0.0.2]

### 🎯 新機能
- **基本コンポーネント**: Text、Button、Input、Formコンポーネント
- **YAML DSL**: 宣言的なUI記述言語
- **VS Code統合**: 拡張機能としての基本機能

### 🔧 改善
- **ファイル監視**: .tui.ymlファイルの自動検出
- **コマンド登録**: プレビュー表示コマンド
- **エラーハンドリング**: 基本的なエラー処理

### 🐛 修正
- **初期化**: 拡張機能の起動問題
- **ファイル処理**: YAMLファイルの読み込みエラー

## [0.0.1]

### 🎉 初回リリース
- **TextUI Designer**: マークダウンに親和性の高いYAML/JSON DSLでUIを設計
- **VS Code拡張**: 即時プレビューと型安全な編集体験
- **基本機能**: プレビュー表示、YAML解析、WebView統合